<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profile Copy — Crypto STaR · Emiratos Dubai Trading</title>
  <meta name="description" content="Perfil del trader — Emiratos Dubai Trading. Estadísticas, PnL, token preferences y copia de estrategias.">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- AOS -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --gold: #b88b18;
      --gold-2: #ffd27a;
      --dark-bg: #07090b;
      --panel: rgba(255,255,255,0.03);
      --glass-border: rgba(255,255,255,0.04);
      --green: #22c55e;
      --muted: #9aa4ad;
    }

    html,body { height:100%; }
    body{
      font-family: 'Poppins', system-ui, Arial;
      background: linear-gradient(180deg,#03060a 0%, #071322 60%);
      color: #e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.3;
    }

    /* Glass panels */
    .glass {
      background: var(--panel);
      backdrop-filter: blur(8px);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
    }

    .glass-soft {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.03);
      border-radius: 12px;
    }

    .shadow-spot {
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    }

    /* small utility */
    .muted { color: var(--muted); }
    .gold { color: var(--gold-2); }
    .btn-gold {
      background: linear-gradient(90deg,var(--gold),var(--gold-2));
      color: #07121a;
      font-weight:700;
    }

    /* charts canvas sizing */
    .chart-card canvas { width:100% !important; height:260px !important; }

    /* responsive tweaks */
    @media (max-width: 900px){
      .chart-card canvas { height:200px !important; }
    }

    /* tooltip / toast */
    .toast {
      position: fixed;
      right: 20px;
      bottom: 20px;
      background: rgba(34,197,94,0.95);
      color: #031316;
      padding: 10px 14px;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
      transform: translateY(20px);
      opacity: 0;
      transition: all .35s ease;
      z-index: 9999;
    }
    .toast.show { opacity:1; transform: translateY(0); }

    /* table look */
    .mini-table td, .mini-table th { padding: .45rem .6rem; border-bottom: 1px dashed rgba(255,255,255,0.03); font-size: .875rem; }

    /* small label */
    .chip { font-size: .75rem; padding: 6px 10px; border-radius: 999px; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.02); }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="w-full fixed top-0 left-0 z-30 backdrop-blur glass-soft shadow-spot">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-yellow-500 to-amber-400 flex items-center justify-center font-bold text-dark">ED</div>
        <div>
          <div class="text-sm muted">Copy Trading / <span class="text-white font-semibold">Lead Trader Details</span></div>
          <div class="text-xs muted">Profile overview</div>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <button id="backBtn" class="px-3 py-2 rounded-md glass hover:brightness-110">← Volver</button>
        <button id="copyProfile" class="px-4 py-2 rounded-full btn-gold shadow">Copy</button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto mt-28 px-4 pb-20">

    <!-- Top header: avatar + basic stats -->
    <section class="grid grid-cols-1 md:grid-cols-3 gap-6 items-start mb-6">
      <div class="md:col-span-3 glass p-6 shadow-spot flex flex-col md:flex-row gap-6 items-start">
        <div class="flex items-center gap-5">
          <div class="w-24 h-24 rounded-full overflow-hidden border-2 border-white/5 flex items-center justify-center" style="background:linear-gradient(135deg,#0ea5a6,#2563eb)">
            <!-- Placeholder avatar -->
            <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120'><rect width='120' height='120' fill='%23256' /></svg>" alt="avatar" class="w-full h-full object-cover"/>
          </div>
          <div>
            <h1 class="text-2xl font-bold">Crypto STaR</h1>
            <div class="text-sm muted">I am a lead trader, always sharing transparent strategies and trading results. Register with my referral code: SCFHR to follow my trades.</div>
          </div>
        </div>

        <div class="ml-auto flex gap-4 items-center">
          <div class="text-center">
            <div class="text-xs muted">Number of Followers</div>
            <div class="font-semibold">341 / 2,000</div>
          </div>
          <div class="text-center">
            <div class="text-xs muted">Days since joining</div>
            <div class="font-semibold">109</div>
          </div>
          <div class="text-center">
            <div class="text-xs muted">Total trades</div>
            <div class="font-semibold">17,910</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Main layout: left sidebar + main content -->
    <section class="grid grid-cols-1 lg:grid-cols-4 gap-6">

      <!-- LEFT COLUMN: performance summary / overview / copy traders -->
      <aside class="lg:col-span-1 flex flex-col gap-4">
        <!-- Performance card -->
        <div class="glass p-4 shadow-spot">
          <div class="flex items-center justify-between mb-3">
            <div class="font-semibold">Performance</div>
            <div class="text-xs muted">30D</div>
          </div>

          <div class="grid grid-cols-2 gap-3">
            <div>
              <div class="text-xs muted">PnL%</div>
              <div class="text-xl font-bold text-green-400">11,253.82%</div>
              <div class="text-xs muted">+37.19</div>
            </div>
            <div>
              <div class="text-xs muted">Profitable Trades</div>
              <div class="text-xl font-bold text-green-400">2.76k</div>
              <div class="text-xs muted">Losing: 1.01k</div>
            </div>

            <div>
              <div class="text-xs muted">Win Rate</div>
              <div class="font-semibold">73.27%</div>
            </div>
            <div>
              <div class="text-xs muted">Copiers Profit</div>
              <div class="font-semibold text-red-400">-110.95k</div>
            </div>
          </div>
        </div>

        <!-- Overview -->
        <div class="glass p-4 shadow-spot">
          <div class="flex items-center justify-between mb-2">
            <div class="font-semibold">Overview</div>
            <div class="text-xs muted">Info</div>
          </div>
          <table class="mini-table w-full text-sm">
            <tbody>
              <tr><td>Lead Trader's Assets</td><td class="text-right">USDT</td></tr>
              <tr><td>Max drawdown</td><td class="text-right">13.18%</td></tr>
              <tr><td>AUM</td><td class="text-right">31.33k USDT</td></tr>
              <tr><td>Total copiers</td><td class="text-right">7.81k</td></tr>
              <tr><td>Profit-sharing ratio</td><td class="text-right">20%</td></tr>
            </tbody>
          </table>
        </div>

        <!-- Copy traders list (left) -->
        <div class="glass p-4 shadow-spot">
          <div class="flex items-center justify-between mb-3">
            <div class="font-semibold">Copy traders</div>
            <div class="text-xs muted">Top 5</div>
          </div>
          <ul class="space-y-2 text-sm">
            <li class="flex items-center justify-between"><div class="flex items-center gap-2"><div class="w-6 h-6 rounded-full bg-yellow-400 text-black flex items-center justify-center text-xs">1</div><div class="text-sm">LBA****492</div></div><div class="text-green-400">11,512.13</div></li>
            <li class="flex items-center justify-between"><div class="flex items-center gap-2"><div class="w-6 h-6 rounded-full bg-blue-500 text-white flex items-center justify-center text-xs">2</div><div class="text-sm">LBA****518</div></div><div class="text-green-400">3,542.95</div></li>
            <li class="flex items-center justify-between"><div class="flex items-center gap-2"><div class="w-6 h-6 rounded-full bg-orange-400 text-white flex items-center justify-center text-xs">3</div><div class="text-sm">LBA****497</div></div><div class="text-green-400">1,900.01</div></li>
            <li class="flex items-center justify-between"><div class="flex items-center gap-2"><div class="w-6 h-6 rounded-full bg-gray-700 text-white flex items-center justify-center text-xs">4</div><div class="text-sm">LBA****935</div></div><div class="text-green-400">1,625.35</div></li>
            <li class="flex items-center justify-between"><div class="flex items-center gap-2"><div class="w-6 h-6 rounded-full bg-gray-700 text-white flex items-center justify-center text-xs">5</div><div class="text-sm">LBA****561</div></div><div class="text-green-400">1,572.36</div></li>
          </ul>
        </div>
      </aside>

      <!-- MAIN COLUMN: charts / panels -->
      <div class="lg:col-span-3 flex flex-col gap-4">

        <!-- Top row: main PnL chart -->
        <div class="glass shadow-spot p-4 chart-card">
          <div class="flex items-center justify-between mb-3">
            <div>
              <div class="text-sm muted">Copy Trading PnL</div>
              <div class="text-lg font-semibold">30D PnL — <span class="text-green-400">11,253.82%</span></div>
            </div>

            <div class="flex items-center gap-3">
              <div class="chip">30D</div>
              <div class="chip">PnL</div>
              <button id="copyChartBtn" class="px-3 py-1 rounded-full glass hover:brightness-110">Export</button>
            </div>
          </div>

          <canvas id="pnlChart"></canvas>
        </div>

        <!-- Second row: left column scatter, right column donut -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
          <div class="lg:col-span-2 glass p-4 shadow-spot">
            <div class="flex items-center justify-between mb-3">
              <div>
                <div class="text-sm muted">Holding Duration</div>
                <div class="text-lg font-semibold">Duración de posiciones (30D)</div>
              </div>
              <div class="chip">30D</div>
            </div>
            <canvas id="holdingChart" style="height:280px;"></canvas>
          </div>

          <div class="glass p-4 shadow-spot">
            <div class="flex items-center justify-between mb-3">
              <div>
                <div class="text-sm muted">Token Preferences</div>
                <div class="text-lg font-semibold">Top Pairs</div>
              </div>
              <div class="chip">30D</div>
            </div>

            <div class="flex flex-col gap-4 items-center">
              <canvas id="donutChart" style="width:160px;height:160px;"></canvas>
              <div class="text-sm muted">ETH/USDT 99.57%</div>
              <div class="w-full">
                <table class="mini-table w-full text-sm">
                  <tbody>
                    <tr><td>Pair</td><td class="text-right">Proportion</td></tr>
                    <tr><td>ETH/USDT</td><td class="text-right">99.57%</td></tr>
                    <tr><td>BTC/USDT</td><td class="text-right">0.43%</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Bottom row: more stats or tabs placeholder -->
        <div class="glass p-4 shadow-spot">
          <div class="flex items-center justify-between mb-3">
            <div class="font-semibold">More details</div>
            <div class="muted text-sm">Order History / Lead orders / Copy traders</div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <div class="text-xs muted mb-2">Number of trades</div>
              <div class="text-lg font-semibold">7,538</div>
            </div>
            <div>
              <div class="text-xs muted mb-2">Average daily trades</div>
              <div class="text-lg font-semibold">149</div>
            </div>
            <div class="md:col-span-2">
              <div class="text-xs muted mb-2">Description</div>
              <div class="text-sm muted">I am a lead trader, always sharing transparent strategies and trading results. Follow to copy trades and see detailed history.</div>
            </div>
          </div>
        </div>

      </div>
    </section>
  </main>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite">Copiado ✅</div>

  <!-- Scripts -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 600, once: true });
  </script>

  <script>
    // Utility
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));
    function money(n){ return Number(n).toLocaleString(); }
    function showToast(text, success=true){
      const t = document.getElementById('toast');
      t.textContent = text;
      t.style.background = success ? 'rgba(34,197,94,0.95)' : 'rgba(245,158,11,0.95)';
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), 1600);
    }

    // Mock data generation helpers
    function genPnLSeries(days=30, base=0.02){
      const arr = []; let v = 0;
      for(let i=0;i<days;i++){
        // create plateau + jump pattern resembling screenshot
        if(i===5) v += 0.45 * (1 + Math.random()*0.1);
        else if(i > 5 && i < 25) v += (Math.random()*0.01 - 0.003);
        else if(i===25) v += 0.02;
        else if(i===29) v += 0.18 + Math.random()*0.06;
        arr.push(parseFloat((v).toFixed(4)));
      }
      // normalize to a visible scale (0..1) then scale to percent
      const min = Math.min(...arr), max = Math.max(...arr);
      const scaled = arr.map(x => (x - min) / ((max - min) || 1) * 110); // up to ~11000% style
      return scaled;
    }

    // PnL chart
    const pnlCtx = document.getElementById('pnlChart').getContext('2d');
    const pnlData = genPnLSeries(30);
    const pnlChart = new Chart(pnlCtx, {
      type: 'line',
      data: {
        labels: Array.from({length:pnlData.length}, (_,i)=> i<10? `09-${10+i}` : `10-${i-9}`),
        datasets: [{
          label: 'PnL%',
          data: pnlData,
          borderColor: '#22c55e',
          backgroundColor: 'rgba(34,197,94,0.06)',
          borderWidth: 2,
          pointRadius: 0,
          tension: 0.25,
          fill: true
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        elements: { line: { borderCapStyle: 'round' } },
        plugins: {
          legend: { display: false },
          tooltip: { mode: 'index', intersect: false, callbacks: {
            label: ctx => {
              const v = ctx.parsed.y;
              return `PnL: ${v.toFixed(2)}%`;
            }
          } }
        },
        scales: {
          x: { grid: { display: false }, ticks: { color: '#9aa4ad' } },
          y: {
            grid: { color: 'rgba(255,255,255,0.03)' }, ticks: { color: '#9aa4ad' },
            beginAtZero: true
          }
        }
      }
    });

	// Holding duration scatter (fixed version)
	const holdingCtx = document.getElementById('holdingChart').getContext('2d');
	const scatterData = {
	  datasets: [
		{
		  label: 'Profit',
		  data: Array.from({ length: 18 }, () => ({
			x: Math.random() * 30,
			y: Math.random() * 0.8
		  })),
		  backgroundColor: 'rgba(34,197,94,0.9)',
		  pointRadius: 5
		},
		{
		  label: 'Loss',
		  data: Array.from({ length: 6 }, () => ({
			x: Math.random() * 30,
			y: -Math.random() * 0.4
		  })),
		  backgroundColor: 'rgba(249,115,22,0.9)',
		  pointRadius: 5
		}
	  ]
	};


// --- Antes de crear charts: destruir si ya existen ---
if (window.holdingChart) { try { window.holdingChart.destroy(); } catch(e){} window.holdingChart = null; }
if (window.donutChart)   { try { window.donutChart.destroy();   } catch(e){} window.donutChart   = null; }

// --- Asegura un alto fijo en los canvases (evita loops al ser responsive) ---
// puedes ajustarlo a lo que mejor quede en tu layout
const holdingCanvas = document.getElementById('holdingChart');
const donutCanvas   = document.getElementById('donutChart');
if (holdingCanvas) { holdingCanvas.style.width = '100%'; holdingCanvas.style.height = '320px'; }
if (donutCanvas)   { donutCanvas.style.width   = '160px'; donutCanvas.style.height   = '160px'; }

// --- Holding duration scatter (estable y sin animaciones infinitas) ---
if (holdingCanvas) {
  const holdingCtx = holdingCanvas.getContext('2d');
  const scatterData = {
    datasets: [
      {
        label: 'Profit',
        data: Array.from({length:18}, ()=> ({ x: +(Math.random()*30).toFixed(2), y: +(Math.random()*0.8).toFixed(3) })),
        backgroundColor: 'rgba(34,197,94,0.9)',
        pointRadius: 5
      },
      {
        label: 'Loss',
        data: Array.from({length:6}, ()=> ({ x: +(Math.random()*30).toFixed(2), y: +( -Math.random()*0.4 ).toFixed(3) })),
        backgroundColor: 'rgba(249,115,22,0.9)',
        pointRadius: 5
      }
    ]
  };

  window.holdingChart = new Chart(holdingCtx, {
    type: 'scatter',
    data: scatterData,
    options: {
      responsive: true,
      maintainAspectRatio: true,      // importante: true porque tenemos height fijo en el canvas
      animation: false,               // evita animaciones que disparen re-renders
      plugins: {
        legend: { labels: { color: '#9aa4ad' } }
      },
      scales: {
        x: {
          title: { display: true, text: 'Holding duration (hours/days)', color: '#9aa4ad' },
          grid: { color: 'rgba(255,255,255,0.03)' },
          ticks: { color: '#9aa4ad' },
          min: 0,                        // límite explícito
          max: 30
        },
        y: {
          title: { display: true, text: 'Profit / Loss', color: '#9aa4ad' },
          grid: { color: 'rgba(255,255,255,0.03)' },
          ticks: { color: '#9aa4ad' },
          min: -1,                       // límite explícito
          max: 1
        }
      }
    }
  });
}

// --- Donut chart (estable, sin animaciones y con cutout fijo) ---
if (donutCanvas) {
  const donutCtx = donutCanvas.getContext('2d');

  window.donutChart = new Chart(donutCtx, {
    type: 'doughnut',
    data: {
      labels: ['ETH/USDT','BTC/USDT','Other'],
      datasets: [{
        data: [99.57, 0.43, 0.0],
        backgroundColor: ['#ffd27a','#f97316','rgba(255,255,255,0.06)'],
        borderWidth: 0,
        hoverOffset: 6
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: true,   // usamos true porque el canvas tiene tamaño fijo
      animation: { duration: 0 },  // nada de animaciones en bucle
      cutout: '70%',               // define el donut (evita recalculaciones)
      plugins: {
        legend: { position: 'bottom', labels: { color: '#9aa4ad' } },
        tooltip: { callbacks: { label: ctx => `${ctx.label}: ${ctx.parsed}%` } }
      }
    }
  });
}

  </script>
</body>
</html>
